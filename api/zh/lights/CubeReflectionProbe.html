<!DOCTYPE html>
<html lang="zh">
  <head>
    <meta charset="utf-8">
    <base href="../../../">
    <script src="page.js"></script>
    <link type="text/css" rel="stylesheet" href="page.css">
  </head>
  <body>
    [page:Object3D] &rarr;

    <h1>[name]</h1>

    <p class="desc">
      将环境 IBL（基于环境照明） 应用于位于其影响体积内的物体的光探头。用于将本地 IBL 添加到场景中。
    </p>


    <h2>代码示例</h2>

    <code>
    const probe = new v3d.CubeReflectionProbe();
    probe.update(scene, renderer);
    app.scene.add(probe);
    </code>


    <h2>构造函数</h2>

    <h3>[name]([param:Integer size])</h3>
    <p>
      size - （可选）纹理大小。默认值为 256。<br/><br/>

      创建新的 [name]。
    </p>


    <h2>属性</h2>

    <p>通用属性查看 [page:Object3D Object3D] 基类。</p>


    <h3>[property:Float influenceDistance]</h3>
    <p>
      控制影响范围（球或框）的大小。如果[page:.influenceType influenceType]等于 [page:Lights v3d.ReflectionProbeTypeSphere]，则此参数定义球体半径，如果[page:.influenceType influenceType]等于 [page:Lights v3d.ReflectionProbeTypeBox]，则定义立方体边缘大小的一半。影响体积用于测试哪些对象受到探针的影响（简单地说是那些包含在体积内的物体）。默认值为 1。<br/><br/>


      建议保持此值和 [page:.parallaxDistance] 相同以获得更一致的结果。
    </p>

    <h3>[property:String influenceGroup]</h3>
    <p>
      将受光照探头影响的场景对象限制为此组。 如果不是 null，则使用它
      而不是 [page:.influenceType] 和 [page:.influenceDistance] 
      来确定哪些对象应该受到影响。 默认值为 null，这意味着
      [page:.influenceType] 和 [page:.influenceDistance] 设置将
      照常使用。
    </p>

    <h3>[property:Boolean influenceGroupInv]</h3>
    <p>
      如果 [page:.influenceGroup] 不为空，则此选项（如果为true）将使其
      仅使不属于 [page:.influenceGroup] 的对象才会受到探测器
      的影响。默认值为 false 。
    </p>

    <h3>[property:Constant influenceType]</h3>
    <p>
      定义影响体积的类型。可以是[page:Lights v3d.ReflectionProbeTypeInfinite]（用于 [page:Scene.worldEnvMapProbe] 探头物体）、[page:Lights v3d.ReflectionProbeTypeSphere] 或 [page:Lights v3d.ReflectionProbeTypeBox]。影响体积用于测试哪些对象受到探针的影响（简单地说是那些包含在体积内的对象）。默认为 [page:Lights v3d.ReflectionProbeTypeSphere]。<br/><br/>

      建议保持此值和 [page:.parallaxDistance] 相同以获得更一致的结果。
    </p>

    <h3>[property:Matrix4 matrixWorldInverse]</h3>
    <p>
      [page:Object3D.matrixWorld matrixWorld]的逆矩阵。
    </p>

    <h3>[property:Float parallaxDistance]</h3>
    <p>
      控制视差效果的球体/框有多大。如果 [page:.parallaxType parallaxType] 等于 [page:Lights v3d.ReflectionProbeTypeSphere]，则此参数定义球体半径，如果  [page:.parallaxType parallaxType] 等于 [page:Lights v3d.ReflectionProbeTypeBox]，则定义立方体边缘大小的一半。视差体积用于计算视差效果。默认值为 1。<br/><br/>

      建议保持此值和 [page:.parallaxDistance] 相同以获得更一致的结果。

    </p>

    <h3>[property:Constant parallaxType]</h3>
    <p>
      定义视差体积的类型。可以是[page:Lights v3d.ReflectionProbeTypeInfinite]（用于 [page:Scene.worldEnvMapProbe]探头物体）、[page:Lights v3d.ReflectionProbeTypeSphere] 或 [page:Lights v3d.ReflectionProbeTypeBox]。视差体积用于计算视差效果。默认为 [page:Lights v3d.ReflectionProbeTypeSphere]。<br/><br/>

      建议保持此值和 [page:.parallaxDistance] 相同以获得更一致的结果。
    </p>

    <h3>[property:Float probeClipEnd]</h3>
    <p>
      位于比此值更远的物体将不会出现在探头的环境贴图中。默认值为 100。
    </p>

    <h3>[property:Float probeClipStart]</h3>
    <p>
      距离该值更近的物体不会出现在探头的环境贴图中。默认值为 0.1。
    </p>

    <h3>[property:Float probeIntensity]</h3>
    <p>
      控制探头环境贴图的强度（曝光）。默认值为 1。
    </p>

    <h3>[property:WebGLRenderTarget renderTarget]</h3>
    <p>
      包含渲染环境贴图的 [page:WebGLRenderTarget] 实例。默认为空。调用 [page:.update] 方法后自动更新。
    </p>

    <h3>[property:String type]</h3>
    <p>
      一个字符串 'CubeReflectionProbe'。这可用于查找所有 CubeReflectionProbe 物体。不应该改变。
    </p>

    <h3>[property:String visibilityGroup]</h3>
    <p>
      如果不为 null，则仅将来自该组的物体渲染到环境贴图中（另请参阅 (see also [page:Object3D.groupNames]）。默认为空，这意味着不使用可见组并且探头渲染所有场景物体。
    </p>

    <h3>[property:Boolean visibilityGroupInv]</h3>
    <p>
      如果[page:.visibilityGroup] 不为 null，则此选项（如果为 true）使其仅将不属于指定 [page:.visibilityGroup] 的物体渲染到环境贴图中。默认为false。
    </p>


    <h2>方法</h2>

    <p>通用方法查看[page:Object3D Object3D]基类。</p>

    <h3>[method:null dispose]()</h3>
    <p>
      从内存中移除与此物体使用的渲染目标相关的资源。
    </p>

    <h3>[method:Boolean intersectsMesh]([param:Mesh mesh])</h3>
    <p>
      mesh - 用于测试交叉点的 [page:Mesh] 物体。<br/><br/>

      检查探头的影响体积（参见 [page:.influenceDistance] 和 [page:.influenceType]）和给定的网格物体之间是否存在任何交集。返回检查结果。确切的计算取决于 [page:.influenceType]，例如对于[page:Lights v3d.ReflectionProbeTypeInfinite]，该方法始终返回  *true*。
    </p>

    <h3>[method:WebGLRenderTarget onUpdate]([param:WebGLCubeRenderTarget cubeRT])</h3>
    <p>
      cubeRT - 包含环境贴图的立方体渲染目标。<br/><br/>
   
      在 [page:.update] 方法中渲染环境贴图后执行的回调。在包含渲染结果的 cubeRT 参数中接收一个 [page:WebGLCubeRenderTarget] 实例。此函数返回的值必须是 [page:WebGLCubeRenderTarget] 的实例，并将用作最终的 [page:WebGLCubeRenderTarget]。默认情况下返回相同的*cubeRT*渲染目标。<br/><br/>

      每次调用 [page:.update] 时，可以覆盖此回调以将自定义更改应用于环境映射。如果其 IBL 环境模式设置为*PMREM*，则它已用于场景中的所有立方体反射探头。

    </p>

    <h3>[method:null setSize]([param:Integer size])</h3>
    <p>
      size - 新环境贴图的大小。<br/><br/>

      设置环境贴图的大小。
    </p>

    <h3>[method:null update]([param:Scene scene], [param:WebGLRenderer renderer])</h3>
    <p>
      scene - 用于渲染的场景。<br/>
      renderer - [page:WebGLRenderer] 的实例。<br/><br/>

      将给定的场景渲染到探头的环境贴图中。渲染结果将在[page:.renderTarget] 属性中。
    </p>

    [sourceHint]
  </body>
</html>
