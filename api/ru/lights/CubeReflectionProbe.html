<!DOCTYPE html>
<html lang="ru">
  <head>
    <meta charset="utf-8">
    <base href="../../../">
    <script src="page.js"></script>
    <link type="text/css" rel="stylesheet" href="page.css">
  </head>
  <body>
    [page:Object3D] &rarr;

    <h1>[name]</h1>

    <p class="desc">
      Световой зонд, который применяет окружение типа IBL к объектам, находящимся в зоне его влияния. Используется для добавления локального IBL в сцену. 
    </p>


    <h2>Пример</h2>

    <code>
    const probe = new v3d.CubeReflectionProbe();
    probe.update(scene, renderer);
    app.scene.add(probe);
    </code>


    <h2>Конструктор</h2>

    <h3>[name]([param:Integer size])</h3>
    <p>
      size - (необязателен) размер текстуры. По умолчанию 256.<br/><br/>

      Создает новый [name].
    </p>


    <h2>Свойства</h2>

    <p>Общие свойства смотрите в базовом классе [page:Object3D Object3D].</p>


    <h3>[property:Float influenceDistance]</h3>
    <p>
      Управляет размером сферы/куба влияния. Этот параметр определяет радиус сферы, если [page:.influenceType influenceType] равно [page:Lights v3d.ReflectionProbeTypeSphere] и половину размера грани куба, если [page:.influenceType influenceType] равно [page:Lights v3d.ReflectionProbeTypeBox]. Объем влияния используется для проверки того, на какие объекты влияет зонд (только на те, которые содержатся внутри объема). По умолчанию - 1.<br/><br/>

      Рекомендуется оставить это значение и [page:.parallaxDistance] одинаковыми для получения более стабильных результатов.
    </p>

    <h3>[property:Constant influenceType]</h3>
    <p>
      Определяет тип объема влияния. Может быть [page:Lights v3d.ReflectionProbeTypeInfinite] (используется для объекта зонда [page:Scene.worldEnvMapProbe]), [page:Lights v3d.ReflectionProbeTypeSphere] или [page:Lights v3d.ReflectionProbeTypeBox]. Объем влияния используется для проверки того, на какие объекты влияет зонд (только на те, которые содержатся внутри объема). По умолчанию это [page:Lights v3d.ReflectionProbeTypeSphere].<br/><br/>

      Рекомендуется оставить это значение и [page:.parallaxType] одинаковыми для получения более стабильных результатов.
    </p>

    <h3>[property:Matrix4 matrixWorldInverse]</h3>
    <p>
      Обратное значение [page:Object3D.matrixWorld matrixWorld].
    </p>

    <h3>[property:Float parallaxDistance]</h3>
    <p>
      Управляет размером сферы/куба для эффекта параллакса. Этот параметр определяет радиус сферы, если [page:.parallaxType ParallaxType] равно [page:Lights v3d.ReflectionProbeTypeSphere] и половину размера грани куба, если [page:.parallaxType ParallaxType] равно [page:Lights v3d.ReflectionProbeTypeBox].  Объем параллакса используется для расчета эффекта параллакса. По умолчанию равен 1.<br/><br/>

      Рекомендуется оставить это значение и [page:.influenceDistance] одинаковыми для получения более стабильных результатов.
    </p>

    <h3>[property:Constant parallaxType]</h3>
    <p>
      Определяет тип параллаксного объема. Может быть [page:Lights v3d.ReflectionProbeTypeInfinite] (используется для объекта зонда [page:Scene.worldEnvMapProbe]), [page:Lights v3d.ReflectionProbeTypeSphere] или [page:Lights v3d.ReflectionProbeTypeBox]. Объем параллакса используется для расчета эффекта параллакса. По умолчанию это [page:Lights v3d.ReflectionProbeTypeSphere].<br/><br/>

      Рекомендуется оставить это значение и [page:.influenceType] одинаковыми для получения более стабильных результатов.
    </p>

    <h3>[property:Float probeClipEnd]</h3>
    <p>
      Объекты, расположенные дальше этого значения, не будут отображаться на карте окружения зонда. По умолчанию - 100.
    </p>

    <h3>[property:Float probeClipStart]</h3>
    <p>
      Объекты, расположенные ближе, чем это значение, не будут отображаться на карте окружения. По умолчанию 0,1.
    </p>

    <h3>[property:Float probeIntensity]</h3>
    <p>
      Управляет интенсивностью (экспозицией) карты окружения зонда. По умолчанию - 1.
    </p>

    <h3>[property:WebGLRenderTarget renderTarget]</h3>
    <p>
      Экземпляр [page:WebGLRenderTarget], содержащий карту окружения для рендеринга. По умолчанию равен null. Обновляется автоматически после вызова метода [page:.update].
    </p>

    <h3>[property:String type]</h3>
    <p>
      Строка 'CubeReflectionProbe'. Она может использоваться для поиска всех объектов CubeReflectionProbe. Не должно быть изменено.
    </p>

    <h3>[property:String visibilityGroup]</h3>
    <p>
      Если не null, то на карту окружения выводятся только объекты из этой группы (смотрите также [page:Object3D.groupNames]). По умолчанию равно null, что означает, что группа видимости не используется и зонд рендерит все объекты сцены.
    </p>

    <h3>[property:Boolean visibilityGroupInv]</h3>
    <p>
      Если [page:.visibilityGroup] не равно null, то этот параметр (если он равен true) делает так, что на карту окружения выводятся только объекты, не принадлежащие указанной [page:.visibilityGroup]. По умолчанию - false.
    </p>


    <h2>Методы</h2>

    <p>Общие методы смотрите в базовом классе [page:Object3D Object3D].</p>

    <h3>[method:null dispose]()</h3>
    <p>
      Удалить из памяти ресурсы, связанные с целями рендеринга, используемыми этим объектом.
    </p>

    <h3>[method:Boolean intersectsMesh]([param:Mesh mesh])</h3>
    <p>
      mesh - объект [page:Mesh] для проверки пересечений.<br/><br/>

      Проверяет, есть ли пересечение между объемом влияния зонда (смотрите [page:.influenceDistance] и [page:.influenceType]) и заданным объектом. Возвращает результат проверки. Точные вычисления зависят от [page:.influenceType], например, для [page:Lights v3d.ReflectionProbeTypeInfinite] метод всегда возвращает *true*.
    </p>

    <h3>[method:WebGLRenderTarget onUpdate]([param:WebGLCubeRenderTarget cubeRT])</h3>
    <p>
      cubeRT - цель кубического рендеринга, содержащая карту окружения.<br/><br/>

      Обратный вызов, выполняемый после рендеринга карты окружения в методе [page:.update]. Получает экземпляр [page:WebGLCubeRenderTarget] в параметре *cubeRT*, который содержит результаты рендеринга. Значение, возвращаемое из этой функции, должно быть экземпляром [page:WebGLRenderTarget] и будет использоваться в качестве конечного [page:.renderTarget]. По умолчанию возвращает ту же *cubeRT* цель рендеринга.<br/><br/>

      Этот обратный вызов можно переопределить, чтобы применять пользовательские изменения к карте окружения при каждом вызове [page:.update]. Он уже используется для всех зондов кубического отражения в сцене, если режим среды IBL установлен на *PMREM*.
    </p>

    <h3>[method:null setSize]([param:Integer size])</h3>
    <p>
      size - новый размер карты окружения.<br/><br/>

      Установите размер карты окружения.
    </p>

    <h3>[method:null update]([param:Scene scene], [param:WebGLRenderer renderer])</h3>
    <p>
      scene - сцену для рендеринга.<br/>
      renderer - экземпляр [page:WebGLRenderer].<br/><br/>

      Рендеринг заданной сцены в карту окружения зонда. Результат рендеринга будет находиться в свойстве [page:.renderTarget].
    </p>

    [sourceHint]
  </body>
</html>
