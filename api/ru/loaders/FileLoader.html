<!DOCTYPE html>
<html lang="ru">
  <head>
    <meta charset="utf-8">
    <base href="../../../">
    <script src="page.js"></script>
    <link type="text/css" rel="stylesheet" href="page.css">
  </head>
  <body>
    [page:Loader] &rarr;

    <h1>[name]</h1>

    <p class="desc">
    Класс низкого уровня для загрузки ресурсов с помощью XMLHttpRequest, используемый внутри большинства загрузчиков.
    Он также может быть использован непосредственно для загрузки файлов любого типа, для которых нет загрузчика.
    </p>

    <h2>Пример</h2>
    <code>
    const loader = new v3d.FileLoader();

    //load a text file and output the result to the console
    loader.load(
      // resource URL
      'example.txt',

      // onLoad callback
      function(data) {
        // output the text to the console
        console.log(data)
      },

      // onProgress callback
      function(xhr) {
        console.log((xhr.loaded / xhr.total * 100) + '% loaded');
      },

      // onError callback
      function(err) {
        console.error('An error happened');
      }
    );
    </code>

    <p>
      <em>Примечание:</em> Кэш должен быть включен с помощью
      <code>v3d.Cache.enabled = true;</code>
      Это глобальное свойство, и его нужно установить только один раз, чтобы оно использовалось всеми загрузчиками, которые используют FileLoader внутри.
      [page:Cache Cache] — это модуль кэша, который хранит ответ от каждого запроса, сделанного через этот загрузчик, поэтому каждый файл запрашивается один раз.
    </p>


    <h2>Конструктор</h2>

    <h3>[name] ([param:LoadingManager manager])</h3>
    <p>
      [page:LoadingManager manager] — [page:LoadingManager loadingManager] для использования загрузчиком.
      По умолчанию [page:DefaultLoadingManager].
    </p>

    <h2>Свойства</h2>
    <p>Общие свойства см. в базовом классе [page:Loader].</p>

    <h3>[property:String mimeType]</h3>
    <p>
      Ожидаемый  [link:https://developer.mozilla.org/en-US/docs/Web/HTTP/Basics_of_HTTP/MIME_types mimeType].
      См. [page:.setMimeType]. По умолчанию *undefined*.
    </p>

    <h3>[property:String responseType]</h3>
    <p>Ожидаемый тип отклика. См. [page:.setResponseType]. По умолчанию *undefined*.</p>

    <h2>Методы</h2>
    <p>Общие методы см. в базовом классе [page:Loader].</p>

    <h3>[method:XMLHttpRequest load]([param:String url], [param:Function onLoad], [param:Function onProgress], [param:Function onError])</h3>
    <p>
      [page:String url] — путь или URL-адрес к файлу. Это также может быть
        [link:https://developer.mozilla.org/en-US/docs/Web/HTTP/Basics_of_HTTP/Data_URIs Data URI].<br>
      [page:Function onLoad] (optional) — Вызывается по завершении загрузки. Аргументом будет загруженный ответ.<br>
      [page:Function onProgress] (optional) — Будет вызываться во время загрузки. Аргументом будет экземпляр XMLHttpRequest,
      который содержит байты .[page:Integer total] и .[page:Integer loaded].<br>
      [page:Function onError] (optional) — Будет вызван, если произошла ошибка.<br><br>

      Загрузите URL и передайте отклик в функцию onLoad.
    </p>

    <h3>[method:FileLoader setMimeType]([param:String mimeType])</h3>
    <p>
      Установите ожидаемый [link:https://developer.mozilla.org/en-US/docs/Web/HTTP/Basics_of_HTTP/MIME_types mimeType]
      загружаемого файла. Обратите внимание, что во многих случаях оно будет определяться автоматически, поэтому по умолчанию оно *undefined*.
    </p>

    <h3>[method:FileLoader setResponseType]([param:String responseType])</h3>
    <p>
      Изменение типа отклика. Допустимыми значениями являются:<br>
      [page:String text] или пустая строка (по умолчанию) - возвращает данные в виде [page:String String].<br>
      [page:String arraybuffer] — загружает данные в [link:https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/ArrayBuffer ArrayBuffer] и возвращает их.<br>
      [page:String blob] — возвращает данные в виде [link:https://developer.mozilla.org/en/docs/Web/API/Blob Blob].<br>
      [page:String document] — разбирает файл, используя [link:https://developer.mozilla.org/en-US/docs/Web/API/DOMParser DOMParser].<br>
      [page:String json] — разбирает файл, используя [link:https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/JSON/parse JSON.parse].<br>
    </p>


    [sourceHint]
  </body>
</html>
