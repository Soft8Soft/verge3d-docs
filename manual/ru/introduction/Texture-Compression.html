<!DOCTYPE html>
<html lang="ru">
  <head>
    <title>Текстурная компрессия в Вердж3Д — Софт Эйт Софт</title>
    <meta charset="utf-8">
    <meta name="description" content="Вердж3Д позволяет использовать текстуры, сжатые с помощью высокоэффективного алгоритма KTX-2/BasisU. Узнайте как использовать его в ваших приложениях.">
    <base href="../../../">
    <script src="page.js"></script>
    <link type="text/css" rel="stylesheet" href="page.css">
  </head>
  <body><article>

    <h1>Текстурная компрессия</h1>

    <p>
      «Вердж3Д» позволяет использовать текстуры, сжатые с помощью высокоэффективного алгоритма KTX-2/BasisU, что существенно снижает потребление видеопамяти и ускоряет рендеринг приложений.
    </p>

    <figure style="max-width: 900px">
      <img src="files/texture-compression/ktx-comparison.jpg">
      <figcaption>Сравнение тестовой модели использующей текстуры в разных форматах (изображение от консорциума «Кронос»).</figcaption>
    </figure>

    [contents]


    [anchor:enabling_texture_compression]

    <h2>Включение текстурной компрессии</h2>

    <p>
      Чтобы включить автоматическую конверсию всех текстур при экспорте, активируйте соответствующую опцию в настройках экспорта:
    </p>

    <v3d-tabs>
      <label>Блендер</label>
      <div>
        <img src="files/texture-compression/enable-blender.jpg" style="max-width: 320px">
      </div>
      <label>3дс Макс</label>
      <div>
        <img src="files/texture-compression/enable-max.jpg" style="max-width: 272px">
      </div>
      <label>Майя</label>
      <div>
        <img src="files/texture-compression/enable-maya.jpg" style="max-width: 434px">
      </div>
    </v3d-tabs>

    <p>
      Также убедитесь что *Texture Decompressor* была включена при создании нового приложения (включена по умолчанию):
    </p>

    <img src="files/texture-compression/texture-decompressor-option.webp" style="max-width: 522px">

    <p>
      Если вы забыли включить параметр *Texture Decompressor*, просто скопируйте файлы *basis_transcoder.js* и *basis_transcoder.wasm* из папки <em>build</em> установочной папки «Вердж3Д» (например <em>C:\Program&nbsp;Files\Verge3D_for_Blender\build</em>) в папку с приложением.
    </p>


    [anchor:checking_your_files]

    <h2>Проверка файлов</h2>

    <p>
      Чтобы проверить, что приложение загружает текстуры с компрессией, запустите его (из диспетчера приложений или сайта где оно развёрнуто). Далее откройте <a href="manual/ru/introduction/FAQ.html#browser_console">консоль браузера</a> и переключитесь на вкладку <strong>Network</strong>.
    </p>

    <img src="files/texture-compression/console-check.jpg">

    <p>
      Перезагрузите приложение, чтобы консоль начала показывать загрузку файлов с самого начала. Найдите в списке ваши текстуры — если всё нормально он будут иметь расширение <strong>.ktx2</strong>.
    </p>

    <p>
      Другой способ проверки компрессии — посмотреть <a href="manual/ru/introduction/Performance-Bottlenecks.html#performance_profile">в профиле производительности</a>.
    </p>


    [anchor:tweaking_compression]

    <h2>Настройки компрессии</h2>

    <p>
      Вы можете переключить используемый алгоритм компрессии для каждой текстуры, для чего предусмотрена соответствующая настройка:
    </p>

    <v3d-tabs>
      <label>Блендер</label>
      <div>
        <img src="files/texture-compression/tweak-blender.jpg" style="max-width: 440px">
      </div>
      <label>3дс Макс</label>
      <div>
        <img src="files/texture-compression/tweak-max.jpg" style="max-width: 343px">
      </div>
      <label>Майя</label>
      <div>
        <img src="files/texture-compression/tweak-maya.jpg" style="max-width: 437px">
      </div>
    </v3d-tabs>

    <dl>
      <dt>Auto</dt>
      <dd>Выбрать алгоритм автоматически. В данный момент эта опция просто включает UASTC.</dd>
      <dt>UASTC</dt>
      <dd>Самый совершенный алгоритм, обеспечивающий максимальное качество. Он подходит для любых текстур включая карты нормалей, ОРМ-карты и др.</dd>
      <dt>ETC1S</dt>
      <dd>Предлагает максимальную степень компрессии и генерирует файлы минимального размера. Тем не менее, он может вызывать артефакты компрессии, поэтому рекомендуется только для текстур с невысокой контрастностью (трава, дерево, кирпичи и т.д.).</dd>
      <dt>Disable</dt>
      <dd>Отключить текстурную компрессию для данной текстуры.</dd>
    </dl>


    [anchor:compressing_hdr_textures]

    <h2>Специальный случай — HDR текстуры</h2>

    <p>
      В силу своих особенностей, компрессия не работает для HDR-изображений. Вместо этого мы используем алгоритм LZMA для сжатия текстур без потерь (аналогичный метод мы используем для компрессии glTF-файлов). Использование LZMA уменьшает размер файлов текстур в 4-6 раз, однако это никак не сказывается на количестве потребляемой видеопамяти. Если вы не хотите использовать такой вид сжатия, переключите настройку алгоритма в *Disabled*.
    </p>


    [anchor:limitations]

    <h2>Ограничения</h2>

    <p>
      И хотя в целом мы рекомендуем включать компрессию для всех сцен, в ряде случаев вам следует иметь в виду некоторые ограничения, которые связаны с использованием этой функции.
    </p>

    <h3>Компрессия увеличивает размер загружаемых данных</h3>

    <p>
      Как заявлено в начале этого раздела, компрессия текстур существенно сокращает количество видеопамяти требуемое вашим приложениям. Однако это не всегда справедливо для файлов текстур, загружаемых по сети. При использовании алгоритма компрессии *UASTC* (или *Auto*), текстуры могут стать значительно больше чем исходные изображения. Если вам важнее именно скорость загрузки (или трафик), отключите компрессию полностью, либо переключитесь на более продвинутый алгоритм *ETC1S*.
    </p>

    <p>
      Начиная с «Вердж3Д» версии 4.2, мы реализовали дополнительную защиту, чтобы размер текстур не увеличивался слишком сильно. Если сжатое изображение становится больше чем в 3 раза больше оригинального, экспортер автоматически отключает компрессию для данного изображения.
    </p>

    <h3>Замедление экспорта</h3>

    <p>
      Компрессия требует времени, что может замедлить экспорт. Чтобы ускорить процесс создания приложения, включайте компрессию только в самом конце.
    </p>

    <h3>Работает только для JPEG и PNG изображений</h3>

    <p>
      Компрессия работает только с JPEG/PNG текстурами. Другие форматы, такие как WebP, BMP и др. не поддерживаются.
    </p>

    <h3>Не поддерживается для размеров текстур не являющихся степенью двойки</h3>

    <p>
      Если экспортер установит, что размеры текстуры не являются степенью двойки (мы не рекомендуем создавать такие текстуры даже если компрессия не нужна), компрессии не произойдёт и в сцене окажется оригинальное изображение. В консоли пакета моделирования будет выведено соответствующее уведомление.
    </p>

    <h3>Не поддерживается для PNG текстур со встроенным ICC-профилем</h3>

    <p>
      PNG изображения со встроенным цветовым профилем (ICC или iCCP) не поддерживаются. Если экспортер обнаружит такой профиль, он будет удалён из изображения перед компрессией. Данная операция может исказить цвета текстуры, особенно если используется нестандартный цветовой профиль (не sRGB).
    </p>

    <p>
      Если удаление профиля не приемлемо, откажитесь от компрессии или примените этот профиль к изображению в каком-нибудь инструменте редактирования («Фотошоп», «ГИМП» и др.).
    </p>


    <h2>Остались вопросы?</h2>

    <p>Задайте их на нашем <a href="https://www.soft8soft.com/ru/форумы/" target="_blank">форуме</a>!</p>

  </article></body>
</html>
